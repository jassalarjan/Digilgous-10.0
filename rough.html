<!-- Modal Structure -->
<div id="myModal-${Event_No}" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="modal-content-${Event_No}"></div>
    </div>
</div>


<script>
    // Function to display the modal box
    function displayModal(eventNo) {
        // Construct modal IDs
        const modalId = `myModal-${eventNo}`;
        const modalContentId = `modal-content-${eventNo}`;

        // Get the modal element
        const modal = document.getElementById(modalId);

        // Get the <span> element that closes the modal
        const span = modal.querySelector(".close");

        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Get the content for the modal and display it
        const modalContent = document.getElementById(modalContentId);
        modalContent.innerHTML = document.getElementById(`fig-${eventNo}`).innerHTML;

        // Display the modal
        modal.style.display = "block";
    }

    let content = document.querySelector(".event-content");

    (async () => {
        let response = await fetch("Events.csv");
        let data = await response.text();

        let workbook = XLSX.read(data, { type: "binary" });

        let sheetNames = workbook.SheetNames;

        sheetNames.forEach((name) => {
            let json = XLSX.utils.sheet_to_json(workbook.Sheets[name]);
            let cardContent = json.map((row, index) => {
                let Event_No = row["Event_No."] || "";
                let Event_Name = row["Event_Name"] || "";
                let Eligibility = row["Eligibility"] || "";
                let Team_Size = row["Team_Size"] || "";
                let No_of_Teams = row["No_of_Teams"] || "";

                return `
        <div class="col-4">
            <figure id="fig-${Event_No}" class="imageRoll">
                <figcaption>
                    <strong>${Event_Name}</strong>
                    <p>${Eligibility}</p>
                    <strong>${Team_Size}</strong>
                    <strong>${No_of_Teams}</strong>
                    <button id="container-${Event_No}" onclick="displayModal('${Event_No}')" class="btn-mod">Know More</button>
                </figcaption>
            </figure>
        </div>
        `;
            }).join('');

            content.innerHTML += `
        <div class="row">
            ${cardContent}
        </div>
        `;

            // Append modals for each event
            json.forEach((row) => {
                let Event_No = row["Event_No."] || "";
                let Event_Descript = row["Event_Descript"] || "";
                let Instructions = row["Instructions"] || "";
                let Judgment = row["Judgment"] || "";

                let modalContent = `
            <h2>${Event_No}</h2>
            <p>${Event_Descript}</p>
            <p>${Instructions}</p>
            <p>${Judgment}</p>
            `;

                // Create modal HTML dynamically
                let modalHTML = `
            <div id="myModal-${Event_No}" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <div id="modal-content-${Event_No}">
                        ${modalContent}
                    </div>
                </div>
            </div>
            `;

                // Append modal HTML to body
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            });
        });
    })();
</script>